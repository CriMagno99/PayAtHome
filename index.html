<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Gestione Spese Casa</title>

<style>
/* === Tema Blu Elegante === */
:root {
--primary: #1e88e5;
--primary-dark: #1565c0;
--accent: #64b5f6;
--background: #f3f7fc;
--text: #333;
--card-bg: #fff;
--success: #43a047;
--danger: #e53935;
}
/* === Stile Base === */
body {
font-family: 'Segoe UI', Arial, sans-serif;
margin: 0;
background: var(--background);
color: var(--text);
line-height: 1.6;
}
header {
background-color: var(--primary);
color: white;
text-align: center;
padding: 20px;
font-size: 1.8em;
letter-spacing: 1px;
box-shadow: 0 2px 6px rgba(0,0,0,0.2);
}
/* === Bottone principale (+) === */
#btn-nuova-spesa {
position: fixed;
bottom: 25px;
right: 25px;
width: 65px;
height: 65px;
background-color: var(--primary);
color: white;
border: none;
border-radius: 50%;
font-size: 36px;
cursor: pointer;
box-shadow: 0 4px 8px rgba(0,0,0,0.2);
transition: all 0.2s ease;
}
#btn-nuova-spesa:hover {
background-color: var(--primary-dark);
transform: scale(1.08);
}
/* === Contenitori === */
main {
padding: 20px;
}
#spese-lista { margin-bottom: 20px; }
/* === Card delle spese === */
.spesa-card {
background: var(--card-bg);
border-left: 5px solid var(--primary);
border-radius: 6px;
box-shadow: 0 2px 5px rgba(0,0,0,0.1);
padding: 15px;
margin-bottom: 12px;
transition: transform 0.2s ease;
}
.spesa-card:hover { transform: translateY(-3px); }
.spesa-card h3 { margin: 0; color: var(--primary-dark); }
.spesa-card small { color: #666; }
.spesa-card button {
background-color: var(--danger);
border: none;
color: white;
padding: 6px 12px;
border-radius: 4px;
cursor: pointer;
margin-top: 8px;
font-size: 0.9em;
transition: background 0.2s ease;
}
.spesa-card button:hover { background-color: #b71c1c; }
/* === Contenitore Totali === */
#totali-container {
background: #e3f2fd;
border-top: 3px solid var(--primary);
border-radius: 6px;
padding: 20px;
font-weight: 500;
color: var(--primary-dark);
box-shadow: 0 1px 4px rgba(0,0,0,0.1);
}
/* === Modal === */
.modal {
display: none;
position: fixed;
z-index: 10;
left: 0;
top: 0;
width: 100%;
height: 100%;
background-color: rgba(0,0,0,0.4);
}
.modal-content {
background-color: var(--card-bg);
margin: 5% auto;
padding: 25px;
border-radius: 10px;
width: 85%;
max-width: 480px;
box-shadow: 0 3px 8px rgba(0,0,0,0.3);
}
.modal-content h2 {
color: var(--primary-dark);
text-align: center;
margin-top: 0;
}
.close {
float: right;
font-size: 26px;
cursor: pointer;
color: var(--primary-dark);
transition: color 0.2s ease;
}
.close:hover { color: var(--danger); }
/* === Form nel Modal === */
form label {
display: block;
margin-top: 10px;
color: var(--primary-dark);
font-weight: 600;
}
form input,
form select,
form textarea {
width: 100%;
padding: 8px;
margin-top: 5px;
border: 1px solid #ccc;
border-radius: 4px;
font-size: 1em;
transition: border 0.2s ease;
}
form input:focus,
form select:focus,
form textarea:focus {
border-color: var(--primary);
outline: none;
box-shadow: 0 0 4px rgba(30, 136, 229, 0.4);
}
form button[type="submit"] {
background-color: var(--primary);
color: white;
border: none;
border-radius: 5px;
padding: 10px 18px;
font-size: 1em;
margin-top: 15px;
cursor: pointer;
transition: background 0.2s ease;
}
form button[type="submit"]:hover { background-color: var(--primary-dark); }
/* === Redditi, Obiettivi, ecc. === */
#redditi-section, #obiettivi-risparmi {
background: #e3f2fd;
border-radius: 8px;
padding: 15px;
margin-top: 25px;
box-shadow: 0 1px 4px rgba(0,0,0,0.1);
}
.reddito-card, .budget-card {
background: #fff;
border-left: 5px solid #43a047;
padding: 12px;
border-radius: 6px;
margin: 8px 0;
box-shadow: 0 1px 3px rgba(0,0,0,0.1);
}
.budget-ok { color: green; }
.budget-over { color: red; }
</style>
</head>

<body>
<header>
<h1>Le mie spese di casa</h1>
</header>
<main>
<div id="spese-lista"></div>
<div id="totali-container"></div>
</main>
<button id="btn-nuova-spesa">+</button>

<!-- Modal -->
<div id="modal-spesa" class="modal">
<div class="modal-content">
<span class="close">&times;</span>
<h2>Nuova Spesa</h2>
<form id="form-spesa">
<label>Categoria:</label>
<select id="categoria">
<option>Affitto / Mutuo</option>
<option>Utenze</option>
<option>Manutenzione</option>
<option>Arredamento</option>
<option>Tasse e Assicurazioni</option>
<option>Altro</option>
</select>
<label>Descrizione:</label>
<input type="text" id="descrizione" required>
<label>Importo (‚Ç¨):</label>
<input type="number" id="importo" step="0.01" required>
<label>Data:</label>
<input type="date" id="data" required>
<label>Frequenza:</label>
<select id="frequenza">
<option>Una tantum</option>
<option>Mensile</option>
<option>Annuale</option>
</select>
<label>Note:</label>
<textarea id="note" rows="2" placeholder="Aggiungi un commento..."></textarea>
<button type="submit">Salva Spesa</button>
</form>
</div>
</div>

<!-- Sezioni -->
<section id="redditi-section">
<h2>üí∞ Entrate mensili</h2>
<div id="redditi-lista"></div>
<button id="btn-nuovo-reddito">‚ûï Aggiungi reddito</button>
</section>

<section id="analisi-bilancio">
<h2>üìä Analisi e Bilancio</h2>
<div id="riepilogo-bilancio"></div>
<div id="media-mensile"></div>
</section>

<section id="obiettivi-risparmi">
<h2>üéØ Obiettivi di Budget & Risparmi</h2>
<div id="obiettivi-container"></div>
<button id="btn-imposta-obiettivi">Ô∏è Imposta Obiettivi di Budget</button>
<hr>
<h3>üíπ Dashboard dei Risparmi</h3>
<div id="dashboard-risparmi"></div>
<hr>
<h3>ü§ñ Previsioni AI</h3>
<div id="previsioni-ai"></div>
</section>

<section id="filtro-mese-anno">
<h2>üìÖ Filtri & Confronti</h2>
<label>Mese: <input type="month" id="filtro-mese"></label>
<label>Anno: <input type="number" id="filtro-anno" min="2000" max="2100"></label>
<button id="btn-applica-filtro">Applica Filtro</button>
<button id="btn-reset-filtro">Reset Filtro</button>
<div id="confronto-mese"></div>
<div id="riassunto-annuale"></div>
</section>

<section id="esportazione-dati">
<h2>üíæ Esporta Dati</h2>
<button id="btn-esporta-json">Esporta JSON</button>
<button id="btn-esporta-pdf">Esporta PDF</button>
</section>

<script>
/**************************************************
* SMART FINANCE v3 ‚Äì Budget, Risparmi, Previsioni
**************************************************/
let spese = JSON.parse(localStorage.getItem("speseCasa")) || [];
let redditi = JSON.parse(localStorage.getItem("redditiCasa")) || [];
let obiettivi = JSON.parse(localStorage.getItem("obiettiviCasa")) || {};
// === Elementi ===
const speseLista = document.getElementById("spese-lista");
const totaliContainer = document.getElementById("totali-container");
const btnNuovaSpesa = document.getElementById("btn-nuova-spesa");
const modalSpesa = document.getElementById("modal-spesa");
const spanClose = document.querySelector(".close");
const formSpesa = document.getElementById("form-spesa");
// === Redditi ===
const redditiLista = document.getElementById("redditi-lista");
const btnNuovoReddito = document.getElementById("btn-nuovo-reddito");
// === Analisi ===
const riepilogoBilancio = document.getElementById("riepilogo-bilancio");
const mediaMensile = document.getElementById("media-mensile");
// === Budget ===
const obiettiviContainer = document.getElementById("obiettivi-container");
const btnImpostaObiettivi = document.getElementById("btn-imposta-obiettivi");
const dashboardRisparmi = document.getElementById("dashboard-risparmi");
const previsioniAI = document.getElementById("previsioni-ai");
// === Toast ===
const toast = document.createElement("div");
toast.id = "toast";
toast.style.cssText =
"position:fixed;bottom:20px;right:20px;background:#1e88e5;color:#fff;padding:10px 18px;border-radius:5px;box-shadow:0 2px 6px rgba(0,0,0,0.2);opacity:0;transition:opacity .3s";
document.body.appendChild(toast);
function mostraToast(msg){toast.textContent=msg;toast.style.opacity="1";setTimeout(()=>toast.style.opacity="0",2000);}
function salvaTutti(){localStorage.setItem("speseCasa",JSON.stringify(spese));localStorage.setItem("redditiCasa",JSON.stringify(redditi));localStorage.setItem("obiettiviCasa",JSON.stringify(obiettivi));}
function autoSave(){salvaTutti();mostraToast("üíæ Salvato automaticamente");}
/**************************************************
* SPESE
**************************************************/
function salvaSpesa(e){
e.preventDefault();
const nuova={categoria:categoria.value,descrizione:descrizione.value.trim(),importo:parseFloat(importo.value),data:data.value,frequenza:frequenza.value,note:note.value.trim(),id:Date.now()};
spese.push(nuova);
autoSave();
aggiornaListaSpese();
chiudiModal();
}
function chiudiModal(){modalSpesa.style.display="none";}
function rimuoviSpesa(id){if(!confirm("Eliminare questa spesa?"))return;spese=spese.filter(s=>s.id!==id);autoSave();aggiornaListaSpese();}
function aggiornaListaSpese(){
speseLista.innerHTML="";
if(spese.length===0){speseLista.innerHTML="<p>Nessuna spesa registrata.</p>";totaliContainer.innerHTML="";aggiornaAnalisi();aggiornaObiettivi();return;}
spese.forEach(s=>{
const card=document.createElement("div");
card.className="spesa-card";
card.innerHTML=`<h3>${s.descrizione}</h3>
<p>${s.categoria} - ${s.frequenza}</p>
<p><strong>${s.importo.toFixed(2)} ‚Ç¨</strong> | ${s.data}</p>
${s.note?`<small>Note: ${s.note}</small><br>`:""}
<button onclick="rimuoviSpesa(${s.id})">Elimina</button>`;
speseLista.appendChild(card);
});
const totaleSpese=spese.reduce((sum,s)=>sum+s.importo,0);
totaliContainer.innerHTML=`<h3>Totale spese:</h3><p>${totaleSpese.toFixed(2)} ‚Ç¨</p>`;
aggiornaAnalisi();aggiornaObiettivi();
}
/**************************************************
* REDDITI
**************************************************/
function aggiungiReddito(){
const mese=prompt("Inserisci il mese (es. 2025-11):");
if(!mese)return;
const fonti=[];
for(let i=0;i<3;i++){
const nome=prompt(`Fonte reddito ${i+1} (lascia vuoto per saltare):`);
if(!nome)break;
const importo=parseFloat(prompt(`Importo per ${nome}:`))||0;
fonti.push({nome,importo});
}
redditi.push({mese,fonti});
autoSave();
aggiornaListaRedditi();
}
function aggiornaListaRedditi(){
redditiLista.innerHTML="";
if(redditi.length===0){redditiLista.innerHTML="<p>Nessun reddito registrato.</p>";aggiornaAnalisi();return;}
redditi.forEach(r=>{
const card=document.createElement("div");
card.className="reddito-card";
const tot=r.fonti.reduce((s,f)=>s+f.importo,0);
card.innerHTML=`<h4>${r.mese}</h4>
${r.fonti.map(f=>`<p>${f.nome}: ${f.importo.toFixed(2)} ‚Ç¨</p>`).join("")}
<strong>Totale: ${tot.toFixed(2)} ‚Ç¨</strong>`;
redditiLista.appendChild(card);
});
aggiornaAnalisi();
}
/**************************************************
* OBIETTIVI
**************************************************/
function impostaObiettivi(){
const mese=prompt("Per quale mese vuoi impostare i budget? (es. 2025-11)");
if(!mese)return;
const categorie=["Trasporti","Alloggi","Mangiare","Attivit√†","Varie"];
obiettivi[mese]={};
categorie.forEach(cat=>{
const val=parseFloat(prompt(`Budget per ${cat} (‚Ç¨):`))||0;
obiettivi[mese][cat]=val;
});
autoSave();
aggiornaObiettivi();
}
function aggiornaObiettivi(){
obiettiviContainer.innerHTML="";
if(Object.keys(obiettivi).length===0){obiettiviContainer.innerHTML="<p>Nessun obiettivo impostato.</p>";return;}
const meseCorrente=new Date().toISOString().slice(0,7);
const budget=obiettivi[meseCorrente];
if(!budget){obiettiviContainer.innerHTML=`<p>Nessun obiettivo per ${meseCorrente}.</p>`;return;}
const speseMese=spese.filter(s=>s.data.startsWith(meseCorrente));
const totaliCat={};
speseMese.forEach(s=>{totaliCat[s.categoria]=(totaliCat[s.categoria]||0)+s.importo;});
for(let cat in budget){
const speso=totaliCat[cat]||0;
const limite=budget[cat];
const diff=limite-speso;
const stato=diff>=0?"OK":"Superato";
const classe=diff>=0?"budget-ok":"budget-over";
obiettiviContainer.innerHTML+=`<div class="budget-card"><strong>${cat}</strong>: ${speso.toFixed(2)}‚Ç¨ / ${limite.toFixed(2)}‚Ç¨ <span class="${classe}">(${stato})</span></div>`;
}
}
/**************************************************
* ANALISI + DASHBOARD + PREVISIONI
**************************************************/
function aggiornaAnalisi(){
const spesePerMese={},redditiPerMese={};
spese.forEach(s=>{const m=s.data.slice(0,7);spesePerMese[m]=(spesePerMese[m]||0)+s.importo;});
redditi.forEach(r=>{redditiPerMese[r.mese]=r.fonti.reduce((sum,f)=>sum+f.importo,0);});
const mesi=new Set([...Object.keys(spesePerMese),...Object.keys(redditiPerMese)]);
const riepilogo=[],totali={entrate:0,spese:0};
mesi.forEach(m=>{const sp=spesePerMese[m]||0;const rd=redditiPerMese[m]||0;totali.entrate+=rd;totali.spese+=sp;riepilogo.push({mese:m,entrate:rd,spese:sp,saldo:rd-sp});});
riepilogoBilancio.innerHTML=`<h3>Bilancio Mensile</h3><table style="width:100%;border-collapse:collapse"><tr><th>Mese</th><th>Entrate</th><th>Spese</th><th>Saldo</th></tr>${riepilogo.map(r=>`<tr><td>${r.mese}</td><td>${r.entrate.toFixed(2)}‚Ç¨</td><td>${r.spese.toFixed(2)}‚Ç¨</td><td style='color:${r.saldo>=0?"green":"red"}'>${r.saldo.toFixed(2)}‚Ç¨</td></tr>`).join("")}</table
